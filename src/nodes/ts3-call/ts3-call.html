<script type="text/javascript">
RED.nodes.registerType("ts3-call", {
    category: "network",
    color: "#a6bbcf",
    defaults: {
        name: { value: "" },
        configid: { type: "ts3-config", value: "" },
        selection: { value: "version" }
    },
    inputs: 1,
    outputs: 1,
    label: function () {
        return this.name || "ts3-call";
    },
});
</script>

<script type="text/html" data-template-name="ts3-call">
<div class="form-row">
    <label for="node-input-name"><i class="fa fa-globe"></i> Name</label>
    <input type="text" id="node-input-name">
</div>
<div class="form-row">
    <label for="node-input-configid"><i class="fa fa-server"></i> Connection</label>
    <input type="text" id="node-input-configid">
</div>
<div class="form-row">
    <label for="node-input-configid"><i class="fa fa-terminal"></i> Function</label>
    <select class="form-select" id="node-input-selection">
        <option value="queryLoginAdd">queryLoginAdd</option>
        <option value="queryLoginDel">queryLoginDel</option>
        <option value="queryLoginList">queryLoginList</option>
        <option value="apiKeyAdd">apiKeyAdd</option>
        <option value="apiKeyList">apiKeyList</option>
        <option value="apiKeyDel">apiKeyDel</option>
        <option value="clientSetServerQueryLogin">clientSetServerQueryLogin</option>
        <option value="clientUpdate">clientUpdate</option>
        <option value="version">version</option>
        <option value="hostInfo">hostInfo</option>
        <option value="instanceInfo">instanceInfo</option>
        <option value="instanceEdit">instanceEdit</option>
        <option value="bindingList">bindingList</option>
        <option value="useByPort">useByPort</option>
        <option value="useBySid">useBySid</option>
        <option value="whoami">whoami</option>
        <option value="serverInfo">serverInfo</option>
        <option value="serverIdGetByPort">serverIdGetByPort</option>
        <option value="serverEdit">serverEdit</option>
        <option value="serverProcessStop">serverProcessStop</option>
        <option value="connectionInfo">connectionInfo</option>
        <option value="serverCreate">serverCreate</option>
        <option value="serverDelete">serverDelete</option>
        <option value="serverStart">serverStart</option>
        <option value="serverStop">serverStop</option>
        <option value="serverGroupCreate">serverGroupCreate</option>
        <option value="serverGroupClientList">serverGroupClientList</option>
        <option value="serverGroupAddClient">serverGroupAddClient</option>
        <option value="serverGroupDelClient">serverGroupDelClient</option>
        <option value="serverGroupsByClientId">serverGroupsByClientId</option>
        <option value="clientAddServerGroup">clientAddServerGroup</option>
        <option value="clientDelServerGroup">clientDelServerGroup</option>
        <option value="serverGroupDel">serverGroupDel</option>
        <option value="serverGroupCopy">serverGroupCopy</option>
        <option value="serverGroupRename">serverGroupRename</option>
        <option value="serverGroupPermList">serverGroupPermList</option>
        <option value="serverGroupAddPerm">serverGroupAddPerm</option>
        <option value="serverGroupDelPerm">serverGroupDelPerm</option>
        <option value="serverTempPasswordAdd">serverTempPasswordAdd</option>
        <option value="serverTempPasswordDel">serverTempPasswordDel</option>
        <option value="serverTempPasswordList">serverTempPasswordList</option>
        <option value="channelCreate">channelCreate</option>
        <option value="channelGroupCreate">channelGroupCreate</option>
        <option value="getChannelById">getChannelById</option>
        <option value="getChannelByName">getChannelByName</option>
        <option value="channelFind">channelFind</option>
        <option value="channelInfo">channelInfo</option>
        <option value="channelMove">channelMove</option>
        <option value="channelDelete">channelDelete</option>
        <option value="channelEdit">channelEdit</option>
        <option value="channelPermList">channelPermList</option>
        <option value="channelSetPerm">channelSetPerm</option>
        <option value="channelSetPerms">channelSetPerms</option>
        <option value="channelDelPerm">channelDelPerm</option>
        <option value="getClientById">getClientById</option>
        <option value="getClientByDbid">getClientByDbid</option>
        <option value="getClientByUid">getClientByUid</option>
        <option value="getClientByName">getClientByName</option>
        <option value="clientInfo">clientInfo</option>
        <option value="clientDbList">clientDbList</option>
        <option value="clientDbInfo">clientDbInfo</option>
        <option value="clientKick">clientKick</option>
        <option value="clientMove">clientMove</option>
        <option value="clientPoke">clientPoke</option>
        <option value="clientPermList">clientPermList</option>
        <option value="clientAddPerm">clientAddPerm</option>
        <option value="clientDelPerm">clientDelPerm</option>
        <option value="customSearch">customSearch</option>
        <option value="customInfo">customInfo</option>
        <option value="customDelete">customDelete</option>
        <option value="customSet">customSet</option>
        <option value="sendTextMessage">sendTextMessage</option>
        <option value="sendChannelMessage">sendChannelMessage</option>
        <option value="getServerGroupById">getServerGroupById</option>
        <option value="getServerGroupByName">getServerGroupByName</option>
        <option value="getChannelGroupById">getChannelGroupById</option>
        <option value="getChannelGroupByName">getChannelGroupByName</option>
        <option value="setClientChannelGroup">setClientChannelGroup</option>
        <option value="deleteChannelGroup">deleteChannelGroup</option>
        <option value="channelGroupCopy">channelGroupCopy</option>
        <option value="channelGroupRename">channelGroupRename</option>
        <option value="channelGroupPermList">channelGroupPermList</option>
        <option value="channelGroupAddPerm">channelGroupAddPerm</option>
        <option value="channelGroupDelPerm">channelGroupDelPerm</option>
        <option value="channelGroupClientList">channelGroupClientList</option>
        <option value="permOverview">permOverview</option>
        <option value="permissionList">permissionList</option>
        <option value="permIdGetByName">permIdGetByName</option>
        <option value="permIdsGetByName">permIdsGetByName</option>
        <option value="permGet">permGet</option>
        <option value="permFind">permFind</option>
        <option value="permReset">permReset</option>
        <option value="privilegeKeyList">privilegeKeyList</option>
        <option value="privilegeKeyAdd">privilegeKeyAdd</option>
        <option value="serverGroupPrivilegeKeyAdd">serverGroupPrivilegeKeyAdd</option>
        <option value="channelGroupPrivilegeKeyAdd">channelGroupPrivilegeKeyAdd</option>
        <option value="privilegeKeyDelete">privilegeKeyDelete</option>
        <option value="privilegeKeyUse">privilegeKeyUse</option>
        <option value="messageList">messageList</option>
        <option value="messageAdd">messageAdd</option>
        <option value="messageDel">messageDel</option>
        <option value="messageGet">messageGet</option>
        <option value="messageUpdate">messageUpdate</option>
        <option value="complainList">complainList</option>
        <option value="complainAdd">complainAdd</option>
        <option value="complainDel">complainDel</option>
        <option value="banList">banList</option>
        <option value="ban">ban</option>
        <option value="banClient">banClient</option>
        <option value="banDel">banDel</option>
        <option value="logView">logView</option>
        <option value="logAdd">logAdd</option>
        <option value="gm">gm</option>
        <option value="clientFind">clientFind</option>
        <option value="clientGetIds">clientGetIds</option>
        <option value="clientGetDbidFromUid">clientGetDbidFromUid</option>
        <option value="clientGetNameFromUid">clientGetNameFromUid</option>
        <option value="clientGetUidFromClid">clientGetUidFromClid</option>
        <option value="clientGetNameFromDbid">clientGetNameFromDbid</option>
        <option value="clientEdit">clientEdit</option>
        <option value="clientDbFind">clientDbFind</option>
        <option value="clientDbEdit">clientDbEdit</option>
        <option value="clientDbDelete">clientDbDelete</option>
        <option value="serverList">serverList</option>
        <option value="channelClientPermList">channelClientPermList</option>
        <option value="channelGroupList">channelGroupList</option>
        <option value="serverGroupList">serverGroupList</option>
        <option value="channelList">channelList</option>
        <option value="clientList">clientList</option>
        <option value="ftList">ftList</option>
        <option value="ftGetFileList">ftGetFileList</option>
        <option value="ftGetFileInfo">ftGetFileInfo</option>
        <option value="ftStop">ftStop</option>
        <option value="ftDeleteFile">ftDeleteFile</option>
        <option value="ftCreateDir">ftCreateDir</option>
        <option value="ftRenameFile">ftRenameFile</option>
        <option value="ftInitUpload">ftInitUpload</option>
        <option value="ftInitDownload">ftInitDownload</option>
        <option value="uploadFile">uploadFile</option>
        <option value="downloadFile">downloadFile</option>
        <option value="downloadIcon">downloadIcon</option>
        <option value="uploadIcon">uploadIcon</option>
        <option value="getIconId">getIconId</option>
        <option value="createSnapshot">createSnapshot</option>
        <option value="deploySnapshot">deploySnapshot</option>
    </select>
</div>
</script>

<script type="text/html" data-help-name="ts3-call">
    <p>Executes TeamSpeak 3 ServerQuery commands.</p>
    
    <h3>Inputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">any | array</span></dt>
        <dd>Arguments to pass to the selected function. Can be a single value or an array of arguments. The elements of the array are passed as parameters to the library function.</dd>
    </dl>
    
    <h3>Outputs</h3>
    <dl class="message-properties">
        <dt>payload <span class="property-type">any</span></dt>
        <dd>The result returned by the ServerQuery function.</dd>
    </dl>
    
    <h3>Configuration</h3>
    <dl class="message-properties">
        <dt>Connection</dt>
        <dd>The ts3-config node to use for connecting to the TeamSpeak server.</dd>
        
        <dt>Function</dt>
        <dd>The ServerQuery function to execute (e.g., <code>clientList</code>, <code>channelList</code>, <code>sendTextMessage</code>).</dd>
    </dl>
    
    <h3>Details</h3>
    <p>This node calls methods on the TeamSpeak ServerQuery client. The function is executed when a message 
    is received, and the result is sent to the output.</p>
    
    <h4>Examples:</h4>
    <ul>
        <li><code>clientList</code> - Get list of connected clients (no arguments needed)</li>
        <li><code>sendTextMessage</code> - Send a message (requires target and message text as arguments)</li>
        <li><code>clientKick</code> - Kick a client (requires client ID and reason)</li>
    </ul>
    
    <h3>References</h3>
    <ul>
        <li><a target="_blank" href="https://www.npmjs.com/package/ts3-nodejs-library">TS3-NodeJS-Library</a></li>
        <li><a target="_blank" href="https://multivit4min.github.io/TS3-NodeJS-Library/classes/TeamSpeak-1.html">Method documentation</a></li>
    </ul>
</script>

